!function(n){var i={};function o(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=n,o.c=i,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=24)}([function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var i="undefined"!=typeof document,o="undefined"!=typeof window,s="undefined"!=typeof navigator,r="undefined"!=typeof screen;function a(){return o?window.location.href:""}function l(){return i?document.referrer:""}function c(e,t){return(e||"").slice(0,t)}function u(){return Math.floor(1e6*Math.random())}var h=512;function f(e,t,n){!n&&0!==n||e.push(t+":"+(!0===n?"1":n))}function d(t,e){var n=[];return t&&Object.keys(t).forEach(function(e){return f(n,e,t[e])}),f(n,"rn",u()),f(n,"c",!!s&&navigator.cookieEnabled),f(n,"s",r?[screen.width,screen.height,screen.colorDepth].join("x"):""),f(n,"en",i?document.charset.toLowerCase():""),f(n,"t",c(e,h)),n.join(":")}var m=1024;function p(e){return c(e,m)}function v(e,t){var n="https://mc.yandex.ru/watch/"+e+"?"+function(n){return Object.keys(n).filter(function(e){var t=n[e];return""!==t&&null!=t}).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(n[e])}).join("&")}(t);"undefined"!=typeof navigator&&navigator.sendBeacon?navigator.sendBeacon(n," "):"undefined"!=typeof fetch?fetch(n,{credentials:"include"}):"undefined"!=typeof Image&&((new Image).src=n)}function y(e){var t=e.browserInfo,n=e.counterId,i=e.pageParams,o=e.userVars,s={"browser-info":d(t,i.title),rn:u(),ut:i.ut};i.url&&(s["page-url"]=p(i.url)),i.referrer&&(s["page-ref"]=p(i.referrer)),o&&(s["site-info"]=JSON.stringify(o)),v(n,s)}n(0),n(1);var g={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},b=/[&<>"'/]/g,w={noClosingTag:["img","input","br","embed","source","link","meta","area","command","base","col","param","wbr","hr","keygen"],ignoredKeys:["b","e","m","c","t","cl","class"],isPlainObj:function(e){return"[object Object]"===Object.prototype.toString.call(e)},build:function(e){if(null==e)return"";var t=[];if(this.isPlainObj(e))return this.tag(e);if(Array.isArray(e)){for(var n=0,i=e.length;n<i;n++)t.push(this.build(e[n]));return t.join("")}return""+e},tag:function(e){var t=e.t||"div",n="<"+t+this.attrs(e);return-1!==this.noClosingTag.indexOf(t)?n+"/>":(n+=">",e.c&&(n+=this.build(e.c)),n+="</"+t+">")},attrs:function(e){var t,n,i=e.b,o=e.e,s=e.m,r=[],a=[];if(i||o){if(i=i||this._currentBlock,o?r.push(this.elem(i,o)):r.push(this.block(i)),this.isPlainObj(s)){for(n in s)s.hasOwnProperty(n)&&r.push(this.elem(i,o,n,s[n]));r.sort();for(var l=0,c=r.length;l<c;l++)r[l]!==r[l-1]&&a.push(r[l])}else a=r;t=this.attr("class",a),this._currentBlock=i}else t=(a=e.cl||e.class)?this.attr("class",a):"";for(n in e)e.hasOwnProperty(n)&&-1===this.ignoredKeys.indexOf(n)&&(t+=this.attr(n,e[n]));return t},attr:function(e,t){return null==t||!1===t?"":" "+e+'="'+function(e){return e.replace(b,function(e){return g[e]})}(Array.isArray(t)?t.join(" "):""+t)+'"'},block:function(e,t,n){return e+this.mod(t,n)},elem:function(e,t,n,i){return e+(t?"__"+t:"")+this.mod(n,i)},mod:function(e,t){return!1===t||null==t?"":"_"+e+(""===t||!0===t?"":"_"+t)},reset:function(){return this._currentBlock="",this}};function _(e){return w.reset().build(e)}var k=function(e,t){return"string"==typeof t&&(t=document.querySelector(t)),"string"==typeof e?(t||document).querySelector(e):e};function C(e,t){var n=k(e,t);return n||console.error("Can't find DOM element \""+e+'"',t),n}function x(e,t){return"string"==typeof e?(t||document).querySelectorAll(e):e}C.js2dom=function(e){var t=document.createElement("div");return t.innerHTML=_(e),t.firstChild},C.on=function(e,t,n){return C(e).addEventListener(t,n,!1),C},C.delegate=function(i,o,e,s){return C(i).addEventListener(e,function(e){for(var t=e.target;t!==i;t=t.parentNode||i){var n="."===o[0]?o.substr(1):o;t.classList.contains(n)&&s.call(t,e)}},!1),C},C.off=function(e,t,n){return C(e).removeEventListener(t,n,!1),C},C.move=function(e,t,n){C.css(e,{left:t+"px",top:n+"px"})},C.size=function(e,t,n){C.css(e,{width:t+"px",height:n+"px"})},C.css=function(e,t){var n=e.style;Object.keys(t).forEach(function(e){n[e]=t[e]})},C.show=function(e){C(e).style.display="block"},C.hide=function(e){C(e).style.display="none"},C.offset=function(e){var t={top:0,left:0};return e&&void 0!==e.getBoundingClientRect&&(t=e.getBoundingClientRect()),{top:t.top+(window.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:t.left+(window.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}};var S,O,L,j=(S=document.createElement("div"),O="Khtml ms O Moz Webkit".split(" "),L=O.length,function(e){if(e in S.style)return!0;for(e=e.replace(/^[a-z]/,function(e){return e.toUpperCase()});L--;)if(O[L]+e in S.style)return!0;return!1});function E(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var T=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return function(e,t,n){t&&E(e.prototype,t),n&&E(e,n)}(e,[{key:"on",value:function(e,t){return this._eventBuffer||(this._eventBuffer=[]),e&&t&&this._eventBuffer.push({type:e,callback:t}),this}},{key:"off",value:function(e,t){for(var n=this._eventBuffer||[],i=0;i<n.length;i++)t===n[i].callback&&e===n[i].type&&(n.splice(i,1),i--);return this}},{key:"trigger",value:function(e,t){for(var n=this._eventBuffer||[],i=0;i<n.length;i++)e===n[i].type&&n[i].callback.call(this,{type:e},t);return this}}]),e}();function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function M(e,t){return!t||"object"!==P(t)&&"function"!=typeof t?H(e):t}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var z=new(function(){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=M(this,D(t).call(this)))._pressedBuffer={},e._pads=[],e.buttonName={"54c-5c4-Wireless Controller":{green:1,a:1,red:2,b:2,yellow:3,y:3,blue:0,x:0,left:16,right:17,up:14,down:15,back:8,start:9,lt:6,lb:4,rt:7,rb:5},xbox:{green:0,a:0,red:1,b:1,yellow:3,v:3,blue:2,x:2,left:14,right:15,up:12,down:13,back:8,start:9,lt:6,lb:4,rt:7,rb:5}},e.supported()?(C.on(window,"gamepadconnected",function(){e.search(),e.trigger("connected"),e._rafId||(e._rafId=window.requestAnimationFrame(e.checkButtons.bind(H(e))))}).on(window,"gamepaddisconnected",function(){e.search(),e.trigger("disconnected"),!e.get().length&&e._rafId&&(window.cancelAnimationFrame(e._rafId),e._rafId=null)}),e):M(e)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(t,T),function(e,t,n){t&&B(e.prototype,t),n&&B(e,n)}(t,[{key:"checkButtons",value:function(){for(var t=this,o=this.get(),e=function(e){var n=o[e];if(!n)return"continue";var i=n.index;t._pressedBuffer[i]=t._pressedBuffer[i]||{},n.buttons.forEach(function(e,t){"object"===P(e)&&(this._pressedBuffer[i][t]&&!e.pressed&&(this.trigger(this.getButtonEventName(t)),this.trigger(this.getButtonEventName(t,n.index)),console.log("name",this.getButtonEventName(t))),this._pressedBuffer[i][t]=e.pressed)},t)},n=0;n<o.length;n++)e(n);this._rafId=window.requestAnimationFrame(this.checkButtons.bind(this))}},{key:"supported",value:function(){return"function"==typeof navigator.getGamepads}},{key:"get",value:function(){return this._pads}},{key:"item",value:function(e){return this.get()[e]}},{key:"count",value:function(){return this.get().length}},{key:"search",value:function(){this._pads=this.supported()?navigator.getGamepads():[]}},{key:"getButtonId",value:function(e,t){var n=this._pads[t]&&this._pads[t].id;return console.log(this._pads[t],this.buttonName[n],n),this.buttonName[n]&&this.buttonName[n][e]}},{key:"getButtonEventName",value:function(e,t){return"gamepad:button-"+e+":index-"+(void 0===t?"*":t)}},{key:"onbutton",value:function(e,t){var n,i,o,s=this;return"string"==typeof e&&void 0!==(n=e.split(":")[1])&&(n=+n),console.log("bbbb",e,s.getButtonId(e,n)),o="number"==typeof(i=e)?i:s.getButtonId(i,n),s.on(s.getButtonEventName(o,n),t),this}},{key:"onbuttons",value:function(e,t){return e.forEach(function(e){this.onbutton(e,t)},this),this}}]),t}());function I(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.build(),this.setEvents(),this.timeout=3e3}return function(e,t,n){t&&I(e.prototype,t),n&&I(e,n)}(e,[{key:"build",value:function(){this._elemConnected=C.js2dom({cl:"gamepad-notice-connected",c:["âœ” ðŸŽ®",{cl:"gamepad-notice-connected__num"}]}),this._elemDisconnected=C.js2dom({cl:"gamepad-notice-disconnected",c:["âœ– ðŸŽ®",{cl:"gamepad-notice-disconnected__num"}]})}},{key:"setEvents",value:function(){z.on("connected",this.showConnected.bind(this)).on("disconnected",this.showDisconnected.bind(this)),document.body.appendChild(this._elemConnected),document.body.appendChild(this._elemDisconnected)}},{key:"showDisconnected",value:function(){var e=this,t="gamepad-notice-disconnected_show",n=this._elemDisconnected;n.classList.add(t),this._disTimer&&(clearTimeout(this._disTimer),this._disTimer=null),this._disTimer=setTimeout(function(){n.classList.remove(t),e._disTimer=null},this.timeout)}},{key:"showConnected",value:function(){var e=this,t="gamepad-notice-connected_show",n=this._elemConnected;n.classList.add(t),this._timer&&(clearTimeout(this._timer),this._timer=null),this._timer=setTimeout(function(){n.classList.remove(t),e._timer=null},this.timeout)}}]),e}());var A,K=navigator.userAgent||navigator.vendor||window.opera,R=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(K)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(K.substr(0,4)),F=document.body;function q(e){e!==A&&(document.body.classList.remove("input_"+A),document.body.classList.add("input_"+e),A=e)}F.classList.add("support_transform3d_"+j("perspective")),F.classList.add("device_"+(R?"mobile":"desktop")),q("mouse"),R?q("touch"):C.on(document,"mousemove",function(){q("mouse")}).on(document,"touchstart",function(){q("touch")}),C.on(document,"keydown",function(){q("keyboard")});n(2),n(3),n(4),n(5);function G(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var W=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.elem=C.js2dom({cl:"back",c:"&times;"}),e.appendChild(this.elem),C.on(this.elem,"click",this.onclick.bind(this))}return function(e,t,n){t&&G(e.prototype,t),n&&G(e,n)}(t,[{key:"show",value:function(){this.elem.classList.add("back_visible")}},{key:"hide",value:function(){this.elem.classList.remove("back_visible")}},{key:"onclick",value:function(){$.back()}}]),t}();function U(e){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function V(e,t){return!t||"object"!==U(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function X(e){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $=new(function(){function e(){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(n=V(this,X(e).call(this)))._current=null,n._buffer={},n._back=new W(document.body),n.on("show",function(e,t){"main"===t.name?n._back.hide():n._back.show()}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(e,T),function(e,t,n){t&&J(e.prototype,t),n&&J(e,n)}(e,[{key:"back",value:function(){return window.history.back(),this.showByLocationHash(),this}},{key:"add",value:function(e){return Array.isArray(e)?e.forEach(function(e){this._add(e)},this):this._add(e),this}},{key:"_add",value:function(e){this._buffer[e.name]=e}},{key:"get",value:function(e){return this._buffer[e]}},{key:"has",value:function(e){return Boolean(this.get(e))}},{key:"show",value:function(e,t){var n=null,i=document.body;if(this._current){if((n=this._current.name)===e)return;this._current.hide(),this._current.elem.classList.remove("page_visible"),i.classList.remove("page_"+n)}var o=this.get(e);return o._isInited||(o.elem=C(".page_"+e),o.init&&o.init(),o._isInited=!0),i.classList.add("page_"+e),o.elem.classList.add("page_visible"),o.show(t),void 0!==o.locationHash&&window.location.hash!=="#"+o.locationHash&&(window.location.hash=o.locationHash),this._current=o,this.trigger("show",o),this}},{key:"hide",value:function(e){return this.get(e).hide(),this}},{key:"showByLocationHash",value:function(){return this.show(this.getNameByLocationHash(window.location.hash)),this}},{key:"getNameByLocationHash",value:function(n){var i;return n=(n||"").replace(/#/,""),Object.keys(this._buffer).some(function(e){var t=this._buffer[e];return t.locationHash===n&&(i=t.name,!0)},this),i||"main"}}]),e}()),Z={set:function(e,t){this._buffer[e]=this._copy(t),this._save()},get:function(e,t){this._isLoaded||(this._load(),this._isLoaded=!0);var n=this._buffer[e];return void 0===n?t:n},lsName:"twintwin",_buffer:{},_load:function(){var e={};try{e=JSON.parse(localStorage.getItem(this.lsName))||{}}catch(e){console.log("Settings from localStorage: parse error.")}e.level=e.level||1,e.maxLevel=e.maxLevel||1,this._buffer=e},_save:function(){try{localStorage.setItem(this.lsName,JSON.stringify(this._buffer))}catch(e){console.log("localStorage.setItem error.")}},_copy:function(e){return JSON.parse(JSON.stringify(e))}};n(6),n(7);function Q(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ee=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.elem=e.elem,this.width=e.width,this.height=e.height,this.padding=e.padding,this.cols=e.cols,this.rows=e.rows,this.x=e.x||0,this.y=e.y||0,e.hidden?this.hide():this.show()}return function(e,t,n){t&&Q(e.prototype,t),n&&Q(e,n)}(t,[{key:"hide",value:function(){!0!==this.hidden&&(this.hidden=!0,this.elem.classList.add("field-cursor_hidden"))}},{key:"show",value:function(){!1!==this.hidden&&(this.hidden=!1,this.elem.classList.remove("field-cursor_hidden"),this.update())}},{key:"update",value:function(){this.size(this.width,this.height,this.padding)}},{key:"size",value:function(e,t,n){this.width=e,this.height=t,this.padding=n,C.size(this.elem,e,t),this.move(this.x,this.y)}},{key:"move",value:function(e,t){var n=this.x,i=this.y;e&&(n+=e),t&&(i+=t),n>this.cols-1&&(n=this.cols-1),n<0&&(n=0),i>this.rows-1&&(i=this.rows-1),i<0&&(i=0),this.x=n,this.y=i,C.move(this.elem,n*(this.width+this.padding),i*(this.height+this.padding))}},{key:"left",value:function(){this.show(),this.move(-1,0)}},{key:"right",value:function(){this.show(),this.move(1,0)}},{key:"up",value:function(){this.show(),this.move(0,-1)}},{key:"down",value:function(){this.show(),this.move(0,1)}},{key:"getXY",value:function(){return{x:this.x,y:this.y}}},{key:"reset",value:function(){this.x=0,this.y=0,this.hidden||this.update()}},{key:"destroy",value:function(){this.elem=null}}]),t}();n(8);function te(e){var t=Math.floor(e/1e3),n=Math.floor(t/60);return n+":"+function(e){return e<10?"0"+e:e}(t-60*n)}var ne=[{name:"",symbols:[]},{name:"Headwear",titleSymbol:"ðŸ‘’",cols:2,rows:2,symbols:["ðŸ‘‘","ðŸ‘’","ðŸŽ©","ðŸŽ“"]},{name:"Shoes",titleSymbol:"ðŸ‘ ",cols:3,rows:2,symbols:["ðŸ‘Ÿ","ðŸ‘ž","ðŸ‘¡","ðŸ‘ ","ðŸ‘¢"]},{name:"Accessories",titleSymbol:"ðŸ‘›",cols:4,rows:3,symbols:["ðŸ‘‘","ðŸ’¼","ðŸ‘œ","ðŸ‘","ðŸ‘›","ðŸ‘“","ðŸŽ€","ðŸŒ‚","ðŸ’„"]},{name:"Numerals",titleSymbol:"3",cols:4,rows:3,symbols:["1","2","3","4","5","6","7","8","9","0"]},{name:"Vegetables",titleSymbol:"ðŸ¥•",cols:4,rows:4,symbols:["ðŸ¥‘","ðŸ†","ðŸ¥”","ðŸ¥•","ðŸŒ½","ðŸŒ¶","ðŸ¥’","ðŸŒ°"]},{name:"Trains",titleSymbol:"ðŸš„",cols:4,rows:4,symbols:["ðŸš‚","ðŸšŠ","ðŸš‰","ðŸšž","ðŸš†","ðŸš„","ðŸš…","ðŸšˆ","ðŸš‡","ðŸš","ðŸš‹","ðŸšƒ"]},{name:"Drinks",titleSymbol:"ðŸ·",cols:5,rows:4,symbols:["ðŸ¼","ðŸ¥›","â˜•","ðŸµ","ðŸ¶","ðŸ¾","ðŸ·","ðŸ¸","ðŸ¹","ðŸº","ðŸ»","ðŸ¥‚"]},{name:"Fruits",titleSymbol:"ðŸ",cols:5,rows:4,symbols:["ðŸˆ","ðŸ‰","ðŸŠ","ðŸ‹","ðŸŒ","ðŸ","ðŸŽ","ðŸ","ðŸ","ðŸ‘","ðŸ’","ðŸ“","ðŸ¥"]},{name:"Flowers and trees",titleSymbol:"ðŸ’",cols:6,rows:4,symbols:["ðŸ’","ðŸŒ¸","ðŸŒ·","ðŸ€","ðŸŒ¹","ðŸŒ»","ðŸŒº","ðŸ","ðŸƒ","ðŸ‚","ðŸŒ¿","ðŸŒ¾","ðŸŒµ","ðŸŒ´","ðŸŒ²","ðŸŒ³","ðŸŒ°","ðŸŒ¼","ðŸ’®"]},{name:"Zodiac Signs",titleSymbol:"â™‹",cols:6,rows:4,symbols:["â™ˆ","â™‰","â™Š","â™‹","â™Œ","â™","â™Ž","â™","â™","â™‘","â™’","â™“","â›Ž"]},{name:"Sweets",titleSymbol:"â™‹",cols:6,rows:4,symbols:["ðŸ¦","ðŸ§","ðŸ¨","ðŸ©","ðŸª","ðŸŽ‚","ðŸ°","ðŸ«","ðŸ¬","ðŸ­","ðŸ®","ðŸ¯"]},{name:"Fashion",titleSymbol:"ðŸ‘—",symbols:["ðŸŽ©","ðŸ‘’","ðŸ‘¢","ðŸ‘•","ðŸ‘”","ðŸ‘š","ðŸ‘—","ðŸŽ½","ðŸ‘–","ðŸ‘˜","ðŸ‘™"]},{name:"Buildings",titleSymbol:"ðŸ¢",symbols:["ðŸ ","ðŸ¡","ðŸ«","ðŸ¢","ðŸ£","ðŸ¥","ðŸ¦","ðŸª","ðŸ©","ðŸ¨","ðŸ’’","â›ª","ðŸ¬","ðŸ¤","ðŸŒ‡","ðŸŒ†","ðŸ¯","ðŸ°","â›º","ðŸ­","ðŸ—¼","ðŸ—¾","ðŸ—»","ðŸŒ„","ðŸŒ…","ðŸŒƒ","ðŸ—½","ðŸŒ‰","ðŸŽ ","ðŸŽ¡","â›²","ðŸŽ¢"]},{name:"People",titleSymbol:"ðŸ‘¨",symbols:["ðŸ‘¦","ðŸ‘§","ðŸ‘¨","ðŸ‘©","ðŸ‘´","ðŸ‘µ","ðŸ‘¶","ðŸ‘¼","ðŸŽ…","ðŸ¤¶","ðŸ‘¸","ðŸ¤´","ðŸ‘°","ðŸ¤µ","ðŸ¤°","ðŸ‘²","ðŸ™","ðŸ’ƒ","ðŸ•º","ðŸ‘ª"]},{name:"Currency",titleSymbol:"â‚¬",bg:!1,symbols:["â‚³","à¸¿","â‚¡","â‚¢","â‚¬","Â£","â‚¤","â‚£","Æ’","â‚²","â‚­","Å","â‚¥","â‚¦","â‚½","â‚±","$","â‚®","â‚©","ï¿¦","Â¥","Â¤"]},{name:"Roman numbers",titleSymbol:"â…¨",bg:!1,symbols:["â… ","â…¡","â…¢","â…£","â…¤","â…¥","â…¦","â…§","â…¨","â…©","â…ª","â…«","â…¬","â…­","â…®","â…¯","â†€","â†","â†‚","â†‡","â†ˆ"]},{name:"Hand Signs",titleSymbol:"ðŸ‘Œ",bg:!1,symbols:["ðŸ‘","ðŸ‘Ž","ðŸ‘Œ","ðŸ‘Š","âœŠ","âœŒ","ðŸ‘‹","âœ‹","ðŸ‘","ðŸ‘†","ðŸ‘‡","ðŸ‘‰","ðŸ‘ˆ","ðŸ™Œ","ðŸ™","â˜","ðŸ‘","ðŸ’ª"]},{name:"Arrows",titleSymbol:"â†—",bg:!1,symbols:["â¬‡","â¬…","âž¡","â†—","â†–","â†˜","â†™","â†”","â†•","ðŸ”„","â—€","â–¶","ðŸ”¼","ðŸ”½","â†©","â†ª","âª","â©","â«","â¬","â¤µ","â¤´","ðŸ”€","ðŸ”ƒ","ðŸ”º","ðŸ”»","â¬†"]},{name:"Food",titleSymbol:"ðŸž",symbols:["ðŸž","ðŸ¥","ðŸ¥–","ðŸ¥ž","ðŸ§€","ðŸ–","ðŸ—","ðŸ¥“","ðŸ”","ðŸŸ","ðŸ•","ðŸŒ­","ðŸŒ®","ðŸŒ¯","ðŸ³","ðŸ²","ðŸ¥—","ðŸ¿","ðŸ±","ðŸ˜","ðŸ™","ðŸš","ðŸ›","ðŸœ","ðŸ","ðŸ ","ðŸ¢","ðŸ£","ðŸ¤","ðŸ¥","ðŸ¡"]},{name:"Stars",titleSymbol:"âœ¯",bg:!1,symbols:["â˜…","â˜†","âœª","âœ¯","âœ¡","âœµ","â‰","â‹","âœ¹","âœ¸","âœ¶","âœ·","âœµ","âœ³","âœ²","âœ±","âœ§","âœ¦","âŸ","âŠ›","ðŸ”¯","ðŸŒ ","ðŸŒŸ","ï¹¡","âƒ","â‚","âœ»","â£","âœ­","â‰›","*","Ù­"]},{name:"Technology",titleSymbol:"ðŸ“€",symbols:["ðŸŽ¥","ðŸ“·","ðŸ“¹","ðŸ“¼","ðŸ’¿","ðŸ“€","ðŸ’½","ðŸ’¾","ðŸ’»","ðŸ“±","â˜Ž","ðŸ“ž","ðŸ“Ÿ","ðŸ“ ","ðŸ“¡","ðŸ“º","ðŸ“»"]},{name:"Sport",titleSymbol:"ðŸ€",symbols:["ðŸŽ¯","ðŸˆ","ðŸ€","âš½","âš¾","ðŸŽ¾","ðŸŽ±","ðŸ‰","ðŸŽ³","â›³","ðŸšµ","ðŸš´","ðŸ","ðŸ‡","ðŸ†","ðŸŽ¿","ðŸ‚","ðŸŠ","ðŸ„","ðŸŽ£"]},{name:"Games and Hobbies",titleSymbol:"ðŸŽ¨",symbols:["ðŸŽ¨","ðŸŽ¬","ðŸŽ¤","ðŸŽ§","ðŸŽ¼","ðŸŽµ","ðŸŽ¶","ðŸŽ¹","ðŸŽ»","ðŸŽº","ðŸŽ·","ðŸŽ¸","ðŸ‘¾","ðŸŽ®","ðŸƒ","ðŸŽ´","ðŸ€„","ðŸŽ²"]}],ie={data:ne,defaultRows:5,defaultCols:6,getTitle:function(e){return e.titleSymbol+" "+e.name},getLevel:function(e){return ne[e]},getRandomLevel:function(){var e=Math.floor(1+Math.random()*(this.data.length-1));return this.getLevel(e)}};function oe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var se=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=e,this.elem=C.js2dom(this.build()),this.container.appendChild(this.elem)}return function(e,t,n){t&&oe(e.prototype,t),n&&oe(e,n)}(t,[{key:"build",value:function(){return{cl:"info-panel",c:[{cl:"info-panel__time",t:"span",c:["Time: ",{t:"span",cl:"info-panel__time-num"}]},{cl:"info-panel__errors",t:"span",c:["Errors: ",{t:"span",cl:"info-panel__errors-num"}]}]}}},{key:"update",value:function(){this.currentTime=Date.now(),this.updatePart("errors-num",this.errors),this.updatePart("time-num",te(this.currentTime-this.startTime))}},{key:"updatePart",value:function(e,t){C(".info-panel__"+e,this.elem).innerHTML=t}},{key:"start",value:function(e){this.stop(),this.errors=0,this.levelTitle=ie.getTitle(e),this.startTime=Date.now(),this.update(),this._timer=setInterval(this.update.bind(this),500)}},{key:"stop",value:function(){this._timer&&clearInterval(this._timer),this._timer=null}}]),t}();n(9);function re(e){for(var t=e.length-1;0<t;t--){var n=Math.floor(Math.random()*(t+1)),i=e[n];e[n]=e[t],e[t]=i}return e}function ae(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var le=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.elem=e.elem,this.cages=C(".field__cages",this.elem),this.padding=5,this.levelData=e.levelData,this.rows=e.rows,this.cols=e.cols,this.field=[],this.cagesCount=this.cols*this.rows,this.fieldCursor=new ee({elem:C(".field-cursor",this.elem),hidden:!0,cols:this.cols,rows:this.rows,padding:this.padding}),this.infoPanel=new se(this.elem),this.setEvents(),this.setControl(e.control)}return function(e,t,n){t&&ae(e.prototype,t),n&&ae(e,n)}(t,[{key:"setEvents",value:function(){var e=this;this.setKeyboardEvents(),this.setMouseEvents(),this.setGamepadEvents(),C.on(window,"resize",function(){e.isHidden||e.resizeCages()})}},{key:"setControl",value:function(e){this.control=e,this.elem.dataset.control=e}},{key:"isControl",value:function(e){return"any"===this.control||this.control===e}},{key:"setMouseEvents",value:function(){var n=this;C.delegate(this.cages,".cage__front","mousedown",function(e){if(n.isControl("mouse")){n.fieldCursor.hide();var t=e.target.parentNode.dataset;n.openCage(t.x,t.y)}})}},{key:"setKeyboardEvents",value:function(){var t=this;C.on(document,"keydown",function(e){if(t.isControl("keyboard1"))switch(e.key){case"ArrowUp":t.fieldCursor.up();break;case"ArrowLeft":t.fieldCursor.left();break;case"ArrowRight":t.fieldCursor.right();break;case"ArrowDown":t.fieldCursor.down();break;case"Enter":t.openCageWithCursor()}if(t.isControl("keyboard2"))switch(e.key){case"W":t.fieldCursor.up();break;case"A":t.fieldCursor.left();break;case"D":t.fieldCursor.right();break;case"S":t.fieldCursor.down()}})}},{key:"setGamepadEvents",value:function(){var e=this;z.onbutton("left",function(){e.isControl("gamepad")&&e.fieldCursor.left()}).onbutton("right",function(){e.isControl("gamepad")&&e.fieldCursor.right()}).onbutton("up",function(){e.isControl("gamepad")&&e.fieldCursor.up()}).onbutton("down",function(){e.isControl("gamepad")&&e.fieldCursor.down()}).onbuttons(["yellow","blue","green"],function(){e.isControl("gamepad")&&e.openCageWithCursor()})}},{key:"createCages",value:function(){this.cages.innerHTML="";for(var e=0;e<this.cols;e++)for(var t=0;t<this.rows;t++){var n=C.js2dom({cl:"cage","data-x":e,"data-y":t,c:[{cl:"cage__front"},{cl:"cage__back emoji"}]});this.cages.appendChild(n)}}},{key:"resizeCages",value:function(){for(var e=this.getSize(),t=0;t<this.cols;t++)for(var n=0;n<this.rows;n++){var i=this.findCage(t,n);i&&C.css(i,{width:e.width+"px",height:e.height+"px",left:t*(e.width+this.padding)+"px",top:n*(e.height+this.padding)+"px",lineHeight:e.height+"px",fontSize:e.fontSize+"px"})}this.fieldCursor.size(e.width,e.height,this.padding)}},{key:"getLevelSymbols",value:function(){for(var e=this.levelData.symbols,t=this.cols*this.rows/2,n=[];t>n.length;)n=n.concat(e);return re((n=n.slice(0,t)).concat(n))}},{key:"getSize",value:function(){var e=Math.floor(this.cages.offsetWidth/this.cols)-this.padding,t=Math.floor(this.cages.offsetHeight/this.rows)-this.padding;return{width:e,height:t,fontSize:.7*Math.min(e,t)}}},{key:"findCage",value:function(e,t){for(var n=x(".cage",this.cages),i=0;i<n.length;i++){var o=n[i],s=o.dataset;if(String(e)===String(s.x)&&String(t)===String(s.y))return o}return null}},{key:"openCageWithCursor",value:function(){var e=this.fieldCursor.getXY();this.openCage(e.x,e.y)}},{key:"openCage",value:function(e,t){var n=this,i=this.findCage(e,t),o=this._openedCages.length,s={x:e,y:t};if(i&&!i.classList.contains("cage_opened")){switch(i.classList.add("cage_opened"),C(".cage__back",i).innerHTML=this.field[t][e],o){case 0:break;case 1:if(this.field[t][e]===this.field[this._openedCages[0].y][this._openedCages[0].x])this.removeOpenedCages(),this.removeCage(e,t);else{this.infoPanel.errors++;var r=[s].concat(this._openedCages);this._openedCages=[],setTimeout(function(){n.closeOpenedCages(r)},700)}s=null;break;case 2:this.closeOpenedCages(),this._openedCages=[]}this.infoPanel.update(),s&&this._openedCages.push(s)}}},{key:"closeOpenedCages",value:function(e){(e||this._openedCages).forEach(function(e){this.closeCage(e.x,e.y)},this)}},{key:"removeOpenedCages",value:function(){this._openedCages.forEach(function(e){this.removeCage(e.x,e.y)},this),this._openedCages=[]}},{key:"removeCage",value:function(e,t){var n=this,i=this.findCage(e,t);i&&(i.classList.add("cage_removed"),this.cagesCount--,this.infoPanel.update(),setTimeout(function(){n.cages.removeChild(i)},200),this.cagesCount||(this.infoPanel.stop(),this.onFinish()))}},{key:"closeCage",value:function(e,t){var n=this.findCage(e,t);n&&(n.classList.remove("cage_opened"),C(".cage__back",n).innerHTML="")}},{key:"initField",value:function(){var e=this.getLevelSymbols(),t=0;this.field=[];for(var n=0;n<this.rows;n++){for(var i=[],o=0;o<this.cols;o++)i.push(e[t]),t++;this.field[n]=i}}},{key:"show",value:function(e){this.field=[],this.levelData=e.levelData,this.cols=e.cols,this.rows=e.rows,this.cagesCount=this.cols*this.rows,this.initField(),this.createCages(),this.resizeCages(),this._openedCages=[],this.infoPanel.start(this.levelData),this.fieldCursor.cols=this.cols,this.fieldCursor.rows=this.rows,this.fieldCursor.reset(),this.isHidden=!1}},{key:"hide",value:function(){this.isHidden=!0,this.infoPanel.stop()}}]),t}();n(10),n(11);function ce(e){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ue(e,t){return!t||"object"!==ce(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function he(e){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fe(e,t){return(fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var de=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ue(this,he(e).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fe(e,t)}(e,T),e}(),me={create:function(e){var t=new de;return Object.assign(t,{domEvents:[],setDomEvents:function(e){e.forEach(function(e){C.on.apply(C,e)},this),this.domEvents=this.domEvents.concat(e)},removeDomEvents:function(){this.domEvents.forEach(function(e){C.off.apply(C,e)}),this.domEvents=[]}}),Object.assign(t,e),t.init&&t.init(),t}},pe=me.create({init:function(){var e=this;this.setDomEvents([[".game-over__restart","click",function(){e.trigger("click","restart")}],[".game-over__next","click",function(){e.trigger("click","next")}]])},updateScore:function(e){C(".game-over__score-i").innerHTML=function(e,t){return t=t||"â€¯",(e=e.toString().split("").reverse().join("").replace(/(\d{3})/g,"$1"+t).split("").reverse().join(""))[0]==t?e.substr(1):e}(e)},show:function(e){C.show(".game-over"),this.calcScore(e)},hide:function(){C.hide(".game-over")},calcScore:function(e){for(var n=this,i=Math.floor(1e6/e.errors/Math.log(e.time+3)),t=function(e){var t=Math.floor(i*e/10);setTimeout(function(){n.updateScore(t)},75*e)},o=0;o<10;o++)t(o)}}),ve={name:"game",locationHash:"game",init:function(){var n=this;this.el=C(".game");var e=this.getLevelData();this._field=new le({elem:C(".field",this.el),rows:e.rows,cols:e.cols,levelData:e.data,control:"any",infoPanel:!0}),this._onKeydown=this._onKeydown.bind(this),this._field.onFinish=function(){var e=Z.get("maxLevel");Z.set("maxLevel",Math.max(e,Z.get("level")+1));var t=this.infoPanel;pe.show({errors:t.errors||1,time:Math.floor((Date.now()-t.startTime)/1e3)||1})},pe.on("click",function(e,t){switch(t){case"menu":$.show("main");break;case"next":n.nextLevel();break;case"restart":n.restart()}})},getLevelData:function(){var e=ie.getLevel(Z.get("level"));return{data:e,rows:e.rows||ie.defaultRows,cols:e.cols||ie.defaultCols}},_onKeydown:function(e){"Escape"===e.key&&$.back()},restart:function(){this.hide(),this.show()},nextLevel:function(){Z.set("level",Z.get("level")+1),this.hide(),this.show()},show:function(){var e=this.getLevelData();pe.hide(),this._field.show({levelData:e.data,cols:e.cols,rows:e.rows}),C.on(document,"keydown",this._onKeydown)},hide:function(){this._field.hide(),C.off(document,"keydown",this._onKeydown)}};n(12),n(13);function ye(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ge=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elem=C(".main-bg"),this.elem.innerHTML=this.getBackground(),this.resize()}return function(e,t,n){t&&ye(e.prototype,t),n&&ye(e,n)}(e,[{key:"getBackground",value:function(){var t=[];return ie.data.forEach(function(e){!1!==e.bg&&(t=t.concat(e.symbols))}),re(t),_(t.map(function(e){return{cl:["main-emoji","emoji"],c:e}}))}},{key:"resize",value:function(){var e=Math.floor(document.documentElement.clientWidth/12),t=this.elem.style;t.fontSize=e+"px",t.lineHeight=e+"px"}},{key:"setOpacity",value:function(e){for(var t=x(".main-emoji",this.elem),n=0;n<t.length;n++)t[n].style.opacity="function"==typeof e?e():e}},{key:"destroy",value:function(){this.elem&&(this.elem.innerHTML="",delete this.elem)}}]),e}(),be=(n(14),n(15),C(".main-logo"));setTimeout(function(){be.classList.add("main-logo_visible")},1e3);n(16),n(17),n(18);var we={name:"main",locationHash:"",init:function(){this._mainBg=new ge,this.setEvents()},setEvents:function(){var e=this;C.on(window,"resize",function(){e._mainBg.resize()}).on(".main-menu__continue","click",function(){this.classList.contains("button_disabled")||$.show("select-level")}).on(".main-menu__new-game","click",function(){Z.set("maxLevel",1),$.show("select-level")}).on(".main-menu__multiplayer","click",function(){$.show("multiplayer")})},show:function(){var e=this,t=C(".main-menu__continue");Z.get("level")?t.classList.remove("button_disabled"):t.classList.add("button_disabled"),this._timer=setInterval(function(){e._mainBg.setOpacity(function(){return.1+.4*Math.random()})},1e3)},hide:function(){this._timer&&clearInterval(this._timer),this._timer=null,this._mainBg.setOpacity(0)}},_e=(n(19),n(20),me.create({init:function(){this.values=[];var o=["mouse","keyboard1","keyboard2","gamepad1"].map(function(e,t){var n=Z.get("control"+t);return-1===this.getIndex(n)?e:n},this),s=[];this.elems=Array.from(x(".select-controls")),this.elems.forEach(function(e,t){var n=this,i=o[t];this.values.push(i),this.updateElem(t),s.push([e,"click",function(){n.selectNext(t)}])},this),this.setDomEvents(s)},getPlayerControl:function(e){return this.values[e]},selectNext:function(e){for(var t=this.getIndex(this.values[e]);-1!==this.values.indexOf(this.controls[t].value);)++t>=this.controls.length-1&&(t=0);var n=this.controls[t].value;this.values[e]=n,Z.set("control"+e,n),this.trigger("change",{playerNum:e,control:n}),this.updateElem(e)},updateElem:function(e){var t=this.controls[this.getIndex(this.values[e])],n=this.elems[e];n.innerHTML=t.text,n.title=t.title},getIndex:function(n){var i=-1;return this.controls.some(function(e,t){return e.value===n&&(i=t,!0)}),i},controls:[{value:"keyboard1",text:"âŒ¨ 1",title:"Keyboard: Cursors + Enter"},{value:"keyboard2",text:"âŒ¨ 2",title:"Keyboard: W, A, D, S + Space"},{value:"mouse",text:"ðŸ–±",title:"Mouse"},{value:"touch",text:"ðŸ¤š",title:"Touch"},{value:"gamepad1",text:"ðŸŽ® 1",title:"Gamepad 1"},{value:"gamepad2",text:"ðŸŽ® 2",title:"Gamepad 2"},{value:"gamepad3",text:"ðŸŽ® 3",title:"Gamepad 3"},{value:"gamepad4",text:"ðŸŽ® 4",title:"Gamepad 4"}]}));n(21);function ke(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ce=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.container=e,this.num=t.num,this.settingName="player"+t.num,this.name=this.getUserName(t.name),this.init()}return function(e,t,n){t&&ke(e.prototype,t),n&&ke(e,n)}(n,[{key:"init",value:function(){this.elem=C.js2dom({cl:"user-panel",c:this.name}),this.container.appendChild(this.elem),this.setEvents()}},{key:"setEvents",value:function(){C.on(this.elem,"click",this._onclick.bind(this))}},{key:"getUserName",value:function(e){return e||Z.get(this.settingName,"Player "+this.num)}},{key:"_onclick",value:function(){var e=window.prompt("Player name:");e&&(this.name=this.getUserName(e),this.elem.innerHTML=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}(this.name),Z.set(this.settingName,this.name))}}]),n}(),xe={name:"multiplayer",locationHash:"multiplayer",init:function(){var n=this;this.el=C(".multiplayer"),this._levelData=ie.getRandomLevel();var e=C(".field_one",this.el);this._fieldOne=new le({elem:e,cols:6,rows:5,levelData:this._levelData,control:_e.getPlayerControl(0),userPanel:new Ce(e,{num:1})});var t=C(".field_two",this.el);this._fieldTwo=new le({elem:t,cols:6,rows:5,levelData:this._levelData,control:_e.getPlayerControl(1),userPanel:new Ce(t,{num:2})}),this._onKeydown=this._onKeydown.bind(this),_e.on("change",function(e,t){0===t.playerNum&&n._fieldOne.setControl(t.control),1===t.playerNum&&n._fieldTwo.setControl(t.control)})},_onKeydown:function(e){"Escape"===e.key&&this._onExit()},getLevelData:function(){var e=ie.getLevel(Z.get("level"));return{data:e,rows:e.rows||ie.defaultRows,cols:e.cols||ie.defaultCols}},show:function(){var e=this.getLevelData(),t={levelData:e.data,cols:e.cols,rows:e.rows};this._fieldOne.show(t),this._fieldTwo.show(t),C.on(document,"keydown",this._onKeydown)},hide:function(){this._fieldOne.hide(),this._fieldTwo.hide(),C.off(document,"keydown",this._onKeydown)}};n(22);function Se(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}new(function(){function e(){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elem=C(".select-level__list",this.elem),this.elem.innerHTML=this.getList(),C.delegate(this.elem,".button","click",function(){var e=parseInt(this.dataset.level,10);Z.set("level",e),$.show("game")}),$.on("show",function(e,t){"select-level"===t.name&&n.update()})}return function(e,t,n){t&&Se(e.prototype,t),n&&Se(e,n)}(e,[{key:"getList",value:function(){var n=[],i=Z.get("maxLevel");return ie.data.forEach(function(e,t){e.name&&n.push({t:"li",cl:"select-level__item",c:{t:"span",cl:["button","button_red","button_middle",t<=i?"":"button_disabled"],"data-level":t,c:[{t:"span",cl:"select-level__emoji emoji",c:e.titleSymbol},e.name]}})}),_(n)}},{key:"update",value:function(){this.elem.innerHTML=this.getList();var e=Z.get("maxLevel"),t=x(".select-level__list .button",this.elem),n=t[e-1]||t[t.length-1];window.scrollTo(0,C.offset(n).top-10)}}]),e}());var Oe,Le,je={name:"select-level",locationHash:"select-level",show:function(){},hide:function(){}},Ee=(n(23),{name:"show-levels",locationHash:"show-levels",init:function(){var e=C(".page_show-levels"),t=ie.data.map(function(e,t){return t?[{t:"h4",c:[t+". "+e.name+" ",{t:"sup",c:+e.symbols.length}]},{c:e.symbols.join(" ")},{t:"br"}]:null});e.innerHTML=_(t)},show:function(){},hide:function(){}});$.add([ve,we,xe,je,Ee]),$.showByLocationHash(),window.addEventListener("hashchange",function(){$.showByLocationHash()},!1),y({counterId:"35250605",pageParams:{referrer:Oe&&void 0!==Oe.referrer?Oe.referrer:l(),title:Oe&&void 0!==Oe.title?Oe.title:i?document.title:"",url:Oe&&void 0!==Oe.url?Oe.url:a()},userVars:Le})}]);